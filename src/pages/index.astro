---
import { Image } from "astro:assets";
import { type CollectionEntry, getCollection } from "astro:content";
import BaseLayout from "../layouts/BaseLayout.astro";
import Button from "../components/ui/Button.astro";
import Card from "../components/ui/Card.astro";

const featuredBeans = await getCollection("beans", ({ data }) => {
	return data.isFeatured === true;
});
---

<BaseLayout title="Nordic Coffee | 静寂と温もりの一杯">
	<!-- Hero Section -->
	<section
		class="relative h-[90vh] flex flex-col items-center justify-center text-center px-6 overflow-hidden bg-canvas"
	>
		<!-- Background Image with Overlay -->
		<div class="absolute inset-0 -z-10">
			<Image
				src="https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?q=80&w=2070&auto=format&fit=crop"
				alt="Nordic Coffee Shop Hero"
				width={2070}
				height={1380}
				class="w-full h-full object-cover opacity-20 filter grayscale-[20%]"
			/>
			<div
				class="absolute inset-0 bg-gradient-to-b from-canvas/60 via-canvas/10 to-canvas"
			>
			</div>
			<!-- Light Leak Effect -->
			<div class="absolute inset-0 light-leak opacity-40"></div>
		</div>

		<header class="relative z-10 max-w-4xl mx-auto space-y-10">
			<span
				class="text-accent font-bold tracking-[0.5em] text-[10px] uppercase mb-4 block animate-fade-in letter-spacing-widest"
				style="animation-delay: 0.2s;">Artisan Coffee Roasters</span
			>
			<h1
				class="text-[clamp(2.5rem,10vw,4.5rem)] font-serif text-ink leading-none text-balance animate-fade-in"
				style="animation-delay: 0.4s;"
			>
				一皿の静寂と、<br class="hidden sm:block" />
				一杯の対話を。
			</h1>
			<p
				class="text-base md:text-lg text-ink-muted max-w-xl mx-auto leading-relaxed animate-fade-in font-serif italic"
				style="animation-delay: 0.6s;"
			>
				冬の澄んだ空気と、木の温もりが重なる場所。<br />
				私たちは、ただコーヒーを淹れるのではありません。
			</p>

			<div
				class="flex flex-wrap justify-center gap-8 pt-6 animate-fade-in"
				style="animation-delay: 0.8s;"
			>
				<Button href="/menu" class="px-10! py-4!">Explore Menu</Button>
				<Button href="/access" variant="outline" class="px-10! py-4!"
					>Visit Us</Button
				>
			</div>
		</header>

		<!-- Scroll Indicator -->
		<div
			class="absolute bottom-8 left-1/2 -translate-x-1/2 flex flex-col items-center gap-4 text-accent/40 animate-bounce"
		>
			<span class="text-[9px] uppercase tracking-[0.4em] vertical-text"
				>Scroll</span
			>
			<div class="w-px h-16 bg-accent/20"></div>
		</div>
	</section>

	<!-- Featured Selection (Editorial Grid) -->
	<section id="menu" class="py-40 px-6 md:px-12 bg-canvas">
		<div class="max-w-7xl mx-auto">
			<div
				class="flex flex-col md:flex-row justify-between items-baseline mb-24 border-b border-ink/5 pb-12"
			>
				<h2 class="text-4xl md:text-6xl font-serif leading-tight">
					Curated <br class="hidden md:block" />
					<span class="text-accent italic font-normal"
						>Selections</span
					>
				</h2>
				<a
					href="/menu"
					class="text-xs uppercase tracking-widest text-accent hover:text-ink transition-colors mt-8 md:mt-0 italic group"
				>
					View full collection
					<span
						class="inline-block transition-transform group-hover:translate-x-1"
						>&rarr;</span
					>
				</a>
			</div>

			<div class="grid grid-cols-1 md:grid-cols-12 gap-12 md:gap-24">
				{
					featuredBeans.map((bean, index: number) => (
						<div
							class:list={[
								"space-y-8 reveal",
								index === 0
									? "md:col-span-7"
									: "md:col-span-5 md:pt-32",
							]}
							style={`transition-delay: ${0.2 * (index + 1)}s;`}
						>
							<Card
								title={bean.data.title}
								description={bean.data.description}
								image={bean.data.featuredImage}
								href={`/beans/${bean.slug}`}
							/>
						</div>
					))
				}

				<!-- Branding Block -->
				<div
					class="md:col-span-7 flex items-center justify-center text-center p-12 md:p-24 border border-ink/5 border-dashed reveal"
					style="transition-delay: 0.7s;"
				>
					<div class="max-w-md space-y-6">
						<p
							class="text-2xl md:text-3xl font-serif italic text-ink/80 leading-relaxed"
						>
							"Coffee is the silence <br /> within the storm."
						</p>
						<p
							class="text-[10px] uppercase tracking-widest text-accent"
						>
							Our Philosophy
						</p>
					</div>
				</div>
			</div>
		</div>
	</section>
</BaseLayout>
